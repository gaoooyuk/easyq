var easyq = require('./index.js');
var assert = require('assert');


function test_avg() {
	var array = [0.04060295407096865, 0.0084545716915001, 0.0018585241927012697, 0.00708228428927677, 0.01406373419520199, 0.020187915872976366, 0.013170425579150918, 0.007830875702063868, -0.01116197772925963, 0.005832958833237512, -0.0008068248809704185, -0.005679929494533149, -0.021999975609756115, 0.003548320683387365, 0.009007755038311548, -0.004014131566201486, -0.01045789448131025, -0.010219228971358916, 0.002904238333376397, 0.013308101478013007, -0.0076346938028218755, -0.002207165925859165, -0.0025570613564267247, -0.008930358294605678]
	assert.equal(0.0025909757436275984000, easyq.avg(array), 'sss');

	array = [0.005237439141004854, 0.005567546695402294, -0.007965206083808664, -0.006559784865893077, 0.02591407525736605, -0.0026695319926950552, 0.008295111189551648, 0.01271996885729178, -0.007726040250640255, -0.012804570513960582, 0.009337526756079276, -0.003890997455058525, 0.009286823199579528, -0.007413909711777232, 0.00805461376195732, 0.0017479112348875669, -0.0033321466152227332, -0.01821428571428577, -0.0062892720111672115, 0.010490753538735584, -0.01644677330754473, 0.005392755610412441, -0.016630116655151312, -0.004958677594882012] 
	assert.equal(-0.0005356994804091177, easyq.avg(array));

	console.log("test_avg passed.")
}

function test_cov() {
	var array1 = [0.003861756607829961,0.0003080229438562345,-0.006936040374892154,-0.00265848947554398,0.020922155757409452,0.00033294422818529613,0.0029735740489150383,0.007353296940171192,-0.0006358682609157863,-0.0060948668292022815,0.005303501750407788,-0.009902710662651575,-0.001979641138770927,-0.005689856405305146,0.004622572121514508,0.006994299883164322,-0.0017386262992554644,-0.012042424911740781,-0.0004183529817378426,0.006474509871794735,0.0014361830452781976,0.008623167356627116,-0.002118870777564831,0.0010085958054164574]
	var array2 = [0.04060295407096865,0.0084545716915001,0.0018585241927012697,0.00708228428927677,0.01406373419520199,0.020187915872976366,0.013170425579150918,0.007830875702063868,-0.01116197772925963,0.005832958833237512,-0.0008068248809704185,-0.005679929494533149,-0.021999975609756115,0.003548320683387365,0.009007755038311548,-0.004014131566201486,-0.01045789448131025,-0.010219228971358916,0.002904238333376397,0.013308101478013007,-0.0076346938028218755,-0.002207165925859165,-0.0025570613564267247,-0.008930358294605678]
	assert.equal(0.0003027611445395465, easyq.cov(array1, array2));

	console.log("test_cov passed.")
}


var connected = easyq.connect({port: 5001, host: "localhost"})
if (!connected) {
	console.log("Cannot connect to kdb+ server.")
	return
}

console.log("Start testing easyq ...")
test_avg()
test_cov()